<Window x:Class="ImageFileRename.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:ImageFileRename"
        Title="Image File Renamer" Height="520" Width="880" FontSize="13">
    <Window.Resources>
        <local:StatusToBackgroundConverter x:Key="StatusToBackgroundConverter"/>
    </Window.Resources>
    <Grid Margin="8">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Border Grid.Row="0" Padding="6" BorderBrush="#CCC" BorderThickness="1" CornerRadius="4" Margin="0,0,0,6">
            <DockPanel>
                <Button x:Name="ChooseSourceButton"
                        Content="Choose Source Folder..."
                        Width="170" Height="30" Margin="0,0,10,0"
                        Click="ChooseSource_OnClick"/>
                <TextBlock x:Name="Foldertext1" Text="Folder:"
                           VerticalAlignment="Center" Margin="0,0,6,0" FontWeight="SemiBold"/>
                <TextBlock x:Name="SourcePathTextBlock"
                           VerticalAlignment="Center"
                           TextTrimming="CharacterEllipsis"
                           ToolTip="{Binding Text, RelativeSource={RelativeSource Self}}"
                           Width="480"/>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                    <CheckBox x:Name="PngCheck" Content=".png" IsChecked="True" Margin="10,0,4,0"
                              ToolTip="Include PNG files in preview / rename"
                              Click="FileTypeCheckBox_OnClick"/>
                    <CheckBox x:Name="JpgCheck" Content=".jpg" IsChecked="False" Margin="0,0,10,0"
                              ToolTip="Include JPG files in preview / rename"
                              Click="FileTypeCheckBox_OnClick"/>
                </StackPanel>
            </DockPanel>
        </Border>

        <Grid Grid.Row="1" Margin="0,0,0,6">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="3*"/>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="2*"/>
            </Grid.ColumnDefinitions>

            <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                <TextBlock Text="Prefix:" VerticalAlignment="Center" Margin="0,0,6,0"/>
                <TextBox x:Name="PrefixTextBox" Width="200" Height="28" Text="GenericPrefix"
                    ToolTip="Base name prefix for all generated files"/>
                <TextBlock Text=" Sample:" Margin="14,0,4,0" VerticalAlignment="Center"/>
                <TextBlock x:Name="SamplePatternTextBlock" VerticalAlignment="Center"
                      Foreground="DimGray" FontStyle="Italic"/>
            </StackPanel>

            <GroupBox Grid.Column="1" Header="Naming Strategy" Margin="8,0,8,0" Padding="4">
                <StackPanel>
                    <RadioButton x:Name="SequentialRadio" Content="Sequential (Prefix_0001)"
                            GroupName="StrategyGroup" Checked="NamingStrategyRadio_OnChecked" IsChecked="True"/>
                    <RadioButton x:Name="TimestampRadio" Content="Timestamp (Prefix_yyyyMMdd_HHmmss_fff_0001)"
                            GroupName="StrategyGroup" Checked="NamingStrategyRadio_OnChecked"/>
                    <RadioButton x:Name="CrcRadio" Content="CRC32 (Prefix_DEADBEEF)" GroupName="StrategyGroup"
                            Checked="NamingStrategyRadio_OnChecked"/>
                </StackPanel>
            </GroupBox>
            <StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
                <CheckBox x:Name="FullPreviewCheckBox" Content="Full Preview"
                  Margin="0,0,12,0" ToolTip="Show every file instead of a small sample"
                  Click="FullPreviewCheckBox_OnClick"/>
                <Button x:Name="PreviewButton" Width="140" Height="32" Margin="0,0,10,0"
                Content="Generate Preview" Click="PreviewButton_OnClick"/>
                <Button x:Name="RenameButton" Width="120" Height="32"
                Content="Rename" IsEnabled="False"
                Click="RenameButton_OnClick"/>
            </StackPanel>
        </Grid>

        <Border Grid.Row="2" BorderBrush="#DDD" BorderThickness="1" CornerRadius="4" Padding="6" Margin="0,0,0,6">
            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                <TextBlock Text="Files:" FontWeight="SemiBold" Margin="0,0,10,0"/>
                <TextBlock Text="Preview the proposed new names before committing the rename."
                           Foreground="Gray"/>
            </StackPanel>
        </Border>

        <ListView x:Name="PreviewList"
                  Grid.Row="3"
                  Margin="0,0,0,6"
                  ItemsSource="{Binding}"
                  AlternationCount="2"
                  VirtualizingPanel.IsVirtualizing="True"
                  VirtualizingPanel.VirtualizationMode="Recycling"
                  ScrollViewer.CanContentScroll="True"
                  SelectionMode="Extended">
            <ListView.Resources>
                <Style TargetType="ListViewItem">
                    <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                    <Setter Property="Background">
                        <Setter.Value>
                            <Binding Path="Status" Converter="{StaticResource StatusToBackgroundConverter}"/>
                        </Setter.Value>
                    </Setter>
                </Style>
            </ListView.Resources>
            <ListView.View>
                <GridView AllowsColumnReorder="True">
                    <GridViewColumn Header="#" Width="40"
                                    DisplayMemberBinding="{Binding Index}"/>
                    <GridViewColumn Header="Original Name" Width="260"
                                    DisplayMemberBinding="{Binding OriginalName}"/>
                    <GridViewColumn Header="Proposed Name" Width="260"
                                    DisplayMemberBinding="{Binding ProposedName}"/>
                    <GridViewColumn Header="Type" Width="60"
                                    DisplayMemberBinding="{Binding Extension}"/>
                    <GridViewColumn Header="Action" Width="80"
                                    DisplayMemberBinding="{Binding Action}"/>
                    <GridViewColumn Header="Status" Width="120"
                                    DisplayMemberBinding="{Binding Status}"/>
                </GridView>
            </ListView.View>
        </ListView>

        <ProgressBar x:Name="RenameProgressBar"
                     Grid.Row="4" Height="20" Minimum="0" Maximum="100" Margin="0,0,0,6"/>

        <DockPanel Grid.Row="5">
            <TextBlock x:Name="StatusTextBlock"
                       DockPanel.Dock="Left"
                       FontWeight="SemiBold"
                       Foreground="Green"/>
            <TextBlock DockPanel.Dock="Right"
                       Text="(Re-run preview after changing prefix or strategy)"
                       Foreground="Gray" FontStyle="Italic"/>
        </DockPanel>
    </Grid>
</Window>
